<style>
:root {
  --bg-color: #ffffff;
  --text-color: #000000;
}

[data-theme="dark"] {
  --bg-color: #121212;
  --text-color: #f5f5f5;
}

body {
  background-color: var(--bg-color);
  color: var(--text-color);
  transition: all 0.3s ease;
}
.dark-mode {
  margin: auto;
  margin-right: 1rem;
  align-items: center;
  justify-content: center;
}
.search-btn {
  background-color: #fe424d;
  color: white;
  border-radius: 25px;
  padding: 0rem 1rem;
  border: none;
  transition: background-color 0.3s ease;
}
.search-btn:hover {
  background-color: #fe424d;
  color: white;
  border-radius: 25px;
  padding: 0rem 1rem;
  border: none;
  transition: background-color 0.3s ease;
}
.search-btn i{
  display: inline;
  margin-right: 0.5rem;
}
.search-input {
  border-radius: 25px;
  padding: 0.5rem 3rem;
  border: 1px solid #ccc;
  transition: all 0.3s ease;
}
</style>

<nav class="navbar navbar-expand-md bg-body-light border-bottom sticky-top">
    <div class="container-fluid">
      <a class="navbar-brand" href="/listings"><i class="fa-regular fa-compass"></i></a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavAltMarkup" >
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
        <div class="navbar-nav">
          <a class="nav-link" href="/listings">Explore</a>
          <div class="form-check-reverse form-switch dark-mode">
            <input class="form-check-input" type="checkbox" id="darkModeSwitch">
            <label class="form-check-label" for="darkModeSwitch">Dark Mode</label>
          </div>
        </div>

        <div class="navbar-nav ms-auto">
          <form class="d-flex" role="search">
            <input class="form-control me-2 search-input" type="search" placeholder="Search destinations">
            <button class="btn search-btn" type="submit"><i class="fa-solid fa-magnifying-glass"></i>Search</button>
          </form>
        </div>

        <div class="navbar-nav ms-auto">          
          <a class="nav-link" href="/listings/new">Airbnb your home</a>
          <% if(!currUser){ %>
            <a class="nav-link" href="/signup"><b>Sign up</b></a>
            <a class="nav-link" href="/login"><b>Log in</b></a>          
          <% } %>
          <% if(currUser) { %>
            <a class="nav-link" href="/logout">Log out</a>
          <% } %>
        </div>
      </div>
    </div>
  </nav>

  <script>
    const darkModeSwitch = document.getElementById('darkModeSwitch');
    const savedTheme = localStorage.getItem('theme');
  
    // Set initial theme based on saved preference or system
    if (savedTheme === 'dark') {
      document.documentElement.setAttribute('data-theme', 'dark');
      darkModeSwitch.checked = true;
    } else if (savedTheme === 'light') {
      document.documentElement.setAttribute('data-theme', 'light');
      darkModeSwitch.checked = false;
    } else {
      const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
      document.documentElement.setAttribute('data-theme', prefersDark ? 'dark' : 'light');
      darkModeSwitch.checked = prefersDark;
    }
  
    // Handle toggle
    darkModeSwitch.addEventListener('change', function () {
      if (this.checked) {
        document.documentElement.setAttribute('data-theme', 'dark');
        localStorage.setItem('theme', 'dark');
      } else {
        document.documentElement.setAttribute('data-theme', 'light');
        localStorage.setItem('theme', 'light');
      }
    });
  </script>
  